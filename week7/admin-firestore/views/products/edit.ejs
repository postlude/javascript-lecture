<%- include ../partial/header %>

<h1>상품 수정</h1>
<form>
    <div class="form-group">
        <label for="name">Name</label>
        <input type="text" class="form-control" id="product-name" placeholder="상품 이름" value="<%= product.name %>"
               name="name">
    </div>
    <div class="form-group">
        <label for="price">Price</label>
        <input type="number" class="form-control" id="product-price" value="<%= product.price %>" name="price">
    </div>
    <div class="form-group">
        <label for="info">Info</label>
        <textarea type="text" class="form-control" name="info"><%= product.info %></textarea>
    </div>
    <div class="form-group">
        <label for="avg_stars">avg_stars</label>
        <select class="form-control" name="avg_stars">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <div class="form-group">
        <label for="total_reviews">total_reviews</label>
        <input type="number" class="form-control" name="total_reviews" value="<%= product.total_reviews %>">
    </div>

</form>

<div class="pull-right">
    <ul class="list-inline">
        <li class="list-inline-item">
            <button class="btn btn-primary" id="edit-btn" value="<%= product.id %>">Submit</button>
        </li>
        <li class="list-inline-item">
            <button class="btn btn-danger" id="delete-btn" value="<%= product.id %>">
                Delete
            </button>
        </li>
    </ul>
</div>


<script>
  $(document).ready(function() {
    $('#delete-btn').on('click', function(e) {
      const id = e.target.value;
      $.ajax({
        method: 'DELETE',
        url: '/products/' + id,
        success: function(res) {
          $(location).attr('href', '/products');
        }
      })
    });

    $('#edit-btn').on('click', function(e) {
      const id = e.target.value;
      const formData = $('form').serialize();
      $.ajax({
        method: 'PUT',
        url: '/products/' + id,
        data: formData,
        success: function(res) {
          alert('success to update.');
        }
      })
    });

  });

</script>

<%- include ../partial/footer %>